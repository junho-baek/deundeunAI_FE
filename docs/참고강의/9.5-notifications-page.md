# 9.5 Notifications Page

## 커밋 요약

NomadCoders 9.5(commit `3245085`)에서는 **알림 목록 페이지**를 구현했습니다. 핵심은 서버에서 알림 데이터를 모아 UI 카드 컴포넌트로 렌더링하고, 각 알림이 어떤 리소스(유저, 제품, 포스트)에 연결되는지에 따라 CTA를 노출하는 것입니다.

## 주요 구현 포인트

### 1. NotificationCard 컴포넌트
- `Card` + `Avatar` 조합으로 기본 UI 구성.
- 알림 타입(`follow`, `review`, `reply`)에 따라 메시지를 다르게 렌더링하고, 필요 시 CTA(프로덕트/포스트 링크)를 동적으로 표시.
- `seen` 여부로 배경색을 달리해 읽지 않은 알림을 강조.

### 2. Notifications Page + Loader
- `loader`에서 `makeSSRClient`와 `getLoggedInUserId`를 사용해 인증을 확인한 뒤 `getNotifications` 쿼리를 호출.
- 가져온 데이터를 `NotificationCard` 리스트로 렌더링.
- `luxon`의 `DateTime`을 사용해 “2 days ago” 스타일의 상대 시간을 표시.

### 3. 사용자 쿼리
- `getNotifications`는 Supabase `notifications` 뷰에서 연관된 `profiles`, `products`, `posts` 데이터를 조인(select)해 한 번에 가져옵니다.
- `seen` 플래그와 `created_at`을 함께 반환하여 클라이언트가 UI 상태를 쉽게 결정할 수 있도록 했습니다.

## 든든AI 적용 사항

1. **알림 카드 컴포넌트 추가**  
   프로젝트 단계 알림(`notifications` 테이블)에도 재사용 가능한 카드가 필요했으므로 `NotificationCard`를 구현해 제목/본문/CTA/읽음 상태를 시각화했습니다.

2. **알림 페이지와 라우트**  
   `/my/notifications` 라우트를 추가하고, 로더에서 Supabase 쿼리를 호출해 최대 50개의 알림을 가져옵니다. 페이지에 들어오면 `read_at`이 없는 항목은 즉시 읽음 처리하여 네비게이션 뱃지가 사라집니다.

3. **네비게이션 뱃지 데이터화**  
   `root.tsx` 로더에서 읽지 않은 알림이 있는지 카운트하고, Navigation 컴포넌트로 전달해 헤더의 빨간 점이 실제 데이터와 연동되도록 했습니다.

추가적으로 메시지 페이지나 다른 알림 타입이 생기면 동일 패턴을 재사용하면 됩니다.
