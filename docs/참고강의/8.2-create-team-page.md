# 8.2 Create Team Page

## ì»¤ë°‹ ìš”ì•½

íŒ€ ìƒì„± í˜ì´ì§€ë¥¼ êµ¬í˜„í•œ ì»¤ë°‹ì…ë‹ˆë‹¤. Mutations íŒŒì¼ ë¶„ë¦¬, Zod ê²€ì¦, Loaderì—ì„œ ì¸ì¦ ì²´í¬, Form í•„ë“œ ê°œì„  ë“±ì˜ íŒ¨í„´ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ì´ì „ ì»¤ë°‹(8.1 Submit Job Page)ê³¼ ìœ ì‚¬í•œ íŒ¨í„´ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

## ì£¼ìš” ë³€ê²½ì‚¬í•­

### 1. Mutations íŒŒì¼ ë¶„ë¦¬ (`mutations.ts`)

**ëª©ì **: ë°ì´í„° ìƒì„± ë¡œì§ì„ ë³„ë„ íŒŒì¼ë¡œ ë¶„ë¦¬

**êµ¬í˜„**:
```typescript
// app/features/teams/mutations.ts
export const createTeam = async (
  client: SupabaseClient<Database>,
  userId: string,
  team: z.infer<typeof formSchema>
) => {
  const { data, error } = await client
    .from("teams")
    .insert({
      team_leader_id: userId,
      team_size: team.size,
      product_name: team.name,
      product_stage: team.stage as "idea" | "prototype" | "mvp" | "product",
      product_description: team.description,
      roles: team.roles,
      equity_split: team.equity,
    })
    .select("team_id")
    .single();

  if (error) {
    throw error;
  }

  return data;
};
```

**íŠ¹ì§•**:
- Zod ìŠ¤í‚¤ë§ˆ íƒ€ì…ì„ ì§ì ‘ ì‚¬ìš© (`z.infer<typeof formSchema>`)
- `userId`ë¥¼ ë³„ë„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ìŒ (ì¸ì¦ëœ ì‚¬ìš©ì ID)
- ì—ëŸ¬ëŠ” ê·¸ëŒ€ë¡œ throwí•˜ì—¬ ìƒìœ„ì—ì„œ ì²˜ë¦¬

### 2. Loaderì—ì„œ ì¸ì¦ ì²´í¬

**êµ¬í˜„**:
```typescript
export const loader = async ({ request }: Route.LoaderArgs) => {
  const { client } = makeSSRClient(request);
  await getLoggedInUserId(client);
};
```

**íŒ¨í„´**: í˜ì´ì§€ ì ‘ê·¼ ì‹œ ì¸ì¦ ì²´í¬, ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ê²½ìš° ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸

### 3. Zod ìŠ¤í‚¤ë§ˆ ì •ì˜ ë° Action í•¨ìˆ˜

**êµ¬í˜„**:
```typescript
export const formSchema = z.object({
  name: z.string().min(1).max(20),
  stage: z.string(),
  size: z.coerce.number().min(1).max(100),
  equity: z.coerce.number().min(1).max(100),
  roles: z.string(),
  description: z.string().min(1).max(200),
});

export const action = async ({ request }: Route.ActionArgs) => {
  const { client } = makeSSRClient(request);
  const userId = await getLoggedInUserId(client);

  const formData = await request.formData();
  const { success, data, error } = formSchema.safeParse(
    Object.fromEntries(formData)
  );

  if (!success) {
    return { fieldErrors: error.flatten().fieldErrors };
  }

  const { team_id } = await createTeam(client, userId, {
    ...data,
  });

  return redirect(`/teams/${team_id}`);
};
```

**íŠ¹ì§•**:
- `z.coerce.number()` ì‚¬ìš©: FormDataì—ì„œ ì˜¤ëŠ” ë¬¸ìì—´ì„ ìë™ìœ¼ë¡œ ìˆ«ìë¡œ ë³€í™˜
- `formSchema`ë¥¼ íŒŒì¼ ìƒë‹¨ì— exportí•˜ì—¬ mutationsì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥
- `safeParse`ë¡œ ì•ˆì „í•œ ê²€ì¦
- `error.flatten().fieldErrors`ë¡œ í•„ë“œë³„ ì—ëŸ¬ ì¶”ì¶œ
- ì„±ê³µ ì‹œ ìƒì„±ëœ ë¦¬ì†ŒìŠ¤ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

### 4. Form í•„ë“œì— `required` ì†ì„± ì¶”ê°€

**ë³€ê²½ ì „**:
```typescript
<InputPair
  label="What is the name of your product?"
  name="name"
  type="text"
  id="name"
/>
```

**ë³€ê²½ í›„**:
```typescript
<InputPair
  label="What is the name of your product?"
  name="name"
  type="text"
  id="name"
  required
/>
{actionData && "fieldErrors" in actionData && (
  <p className="text-red-500">{actionData.fieldErrors.name}</p>
)}
```

**ê°œì„  ì‚¬í•­**:
- `required` ì†ì„± ì¶”ê°€ (HTML5 ìœ íš¨ì„± ê²€ì‚¬)
- `actionData.fieldErrors`ë¡œ ì—ëŸ¬ í‘œì‹œ

### 5. Formì— `method="post"` ëª…ì‹œ

**ë³€ê²½ ì „**:
```typescript
<Form className="...">
```

**ë³€ê²½ í›„**:
```typescript
<Form className="..." method="post">
```

**ì¥ì **: ëª…ì‹œì ìœ¼ë¡œ POST ìš”ì²­ì„ì„ í‘œì‹œ

## ì ìš© ë°©ì•ˆ

### âœ… ì´ë¯¸ ì ìš©ëœ íŒ¨í„´

1. **Mutations íŒŒì¼ ë¶„ë¦¬**: `app/features/projects/mutations.ts` ìƒì„± ì™„ë£Œ
2. **`getLoggedInUserId` ì‚¬ìš©**: ì—¬ëŸ¬ íŒŒì¼ì—ì„œ ì´ë¯¸ ì ìš©ë¨
3. **Zod ê²€ì¦**: `project-create-page.tsx`ì—ì„œ ì‚¬ìš© ì¤‘
4. **Loaderì—ì„œ ì¸ì¦ ì²´í¬**: `project-create-page.tsx`ì—ì„œ ì ìš©ë¨
5. **`fieldErrors` í‘œì‹œ**: `project-create-page.tsx`ì™€ `project-detail-layout.tsx`ì—ì„œ ì‚¬ìš© ì¤‘
6. **Formì— `method="post"` ëª…ì‹œ**: ì¼ë¶€ Formì—ì„œ ì‚¬ìš© ì¤‘

### ğŸ”„ ì¶”ê°€ë¡œ ì ìš© ê°€ëŠ¥í•œ íŒ¨í„´

#### 1. `z.coerce.number()` ì‚¬ìš© (ìš°ì„ ìˆœìœ„: ì¤‘ê°„)

**í˜„ì¬ ìƒíƒœ**: ìˆ«ì í•„ë“œê°€ ì—†ëŠ” ê²½ìš°ê°€ ë§ìŒ

**ì ìš© ë°©ì•ˆ**: ìˆ«ì ì…ë ¥ì´ í•„ìš”í•œ ê²½ìš° `z.coerce.number()` ì‚¬ìš©

**ì˜ˆì‹œ**:
```typescript
// í˜„ì¬ (ë¬¸ìì—´ë¡œ ì²˜ë¦¬)
aspectRatio: z.enum(["9:16", "16:9", "1:1"]).optional(),

// ê°œì„  (ìˆ«ì í•„ë“œê°€ í•„ìš”í•œ ê²½ìš°)
size: z.coerce.number().min(1).max(100),
equity: z.coerce.number().min(1).max(100),
```

**ì¥ì **:
- FormDataì—ì„œ ì˜¤ëŠ” ë¬¸ìì—´ì„ ìë™ìœ¼ë¡œ ìˆ«ìë¡œ ë³€í™˜
- íƒ€ì… ì•ˆì •ì„± í–¥ìƒ
- ì¶”ê°€ ë³€í™˜ ë¡œì§ ë¶ˆí•„ìš”

**ì ìš© ëŒ€ìƒ**:
- í”„ë¡œì íŠ¸ ì„¤ì •ì—ì„œ ìˆ«ì ì…ë ¥ì´ í•„ìš”í•œ ê²½ìš°
- í¬ë ˆë”§ ê´€ë ¨ ìˆ«ì ì…ë ¥ í•„ë“œ

#### 2. Form í•„ë“œì— `required` ì†ì„± ì¶”ê°€ (ìš°ì„ ìˆœìœ„: ë‚®ìŒ)

**í˜„ì¬ ìƒíƒœ**: ì¼ë¶€ Form í•„ë“œì—ë§Œ `required` ì†ì„± ìˆìŒ

**ì ìš© ë°©ì•ˆ**: ëª¨ë“  í•„ìˆ˜ í•„ë“œì— `required` ì†ì„± ì¶”ê°€

**ì˜ˆì‹œ**:
```typescript
<InputPair
  label="í”„ë¡œì íŠ¸ í‚¤ì›Œë“œ"
  name="keyword"
  type="text"
  id="keyword"
  required  // ì¶”ê°€
/>
```

**ì¥ì **:
- HTML5 ìœ íš¨ì„± ê²€ì‚¬ í™œìš©
- ë¸Œë¼ìš°ì € ë ˆë²¨ì—ì„œ í•„ìˆ˜ í•„ë“œ ì²´í¬
- ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

**ì ìš© ëŒ€ìƒ**:
- `project-create-page.tsx`ì˜ í‚¤ì›Œë“œ ì…ë ¥ í•„ë“œ (í˜„ì¬ëŠ” ChatForm ì‚¬ìš©)
- ê¸°íƒ€ í¼ í˜ì´ì§€ë“¤

#### 3. Mutationsì—ì„œ `z.infer<typeof formSchema>` ì‚¬ìš© (ìš°ì„ ìˆœìœ„: ë‚®ìŒ)

**í˜„ì¬ ìƒíƒœ**: Mutationsì—ì„œ ì§ì ‘ íƒ€ì… ì •ì˜

**ì ìš© ë°©ì•ˆ**: FormSchema íƒ€ì…ì„ ì¬ì‚¬ìš©

**ì˜ˆì‹œ**:
```typescript
// í˜„ì¬
export async function createProject(
  client: SupabaseClient<Database>,
  projectData: {
    project_id?: string;
    owner_profile_id: string;
    title: string;
    // ...
  }
)

// ê°œì„  (formSchemaê°€ ìˆëŠ” ê²½ìš°)
import { formSchema } from "./pages/project-create-page";

export async function createProject(
  client: SupabaseClient<Database>,
  projectData: z.infer<typeof formSchema> & {
    project_id?: string;
    owner_profile_id: string;
  }
)
```

**ì¥ì **:
- íƒ€ì… ì¤‘ë³µ ì œê±°
- FormSchemaì™€ Mutations íƒ€ì… ì¼ê´€ì„± ìœ ì§€

**ì£¼ì˜ì‚¬í•­**: FormSchemaì™€ Mutations íŒŒë¼ë¯¸í„°ê°€ ì™„ì „íˆ ì¼ì¹˜í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, í•„ìš”ì‹œ `&`ë¡œ í™•ì¥

## êµ¬í˜„ ìš°ì„ ìˆœìœ„

### ì¤‘ê°„ (ì ì§„ì  ì ìš©)

1. **`z.coerce.number()` ì‚¬ìš©**
   - ì˜í–¥ë„: ì¤‘ê°„ (íƒ€ì… ì•ˆì •ì„±)
   - ë‚œì´ë„: ë‚®ìŒ
   - íš¨ê³¼: ìˆ«ì í•„ë“œ ì²˜ë¦¬ ê°œì„ 

### ë‚®ìŒ (ì„ íƒì‚¬í•­)

2. **Form í•„ë“œì— `required` ì†ì„± ì¶”ê°€**
   - ì˜í–¥ë„: ë‚®ìŒ (UX ê°œì„ )
   - ë‚œì´ë„: ë§¤ìš° ë‚®ìŒ
   - íš¨ê³¼: HTML5 ìœ íš¨ì„± ê²€ì‚¬ í™œìš©

3. **Mutationsì—ì„œ `z.infer<typeof formSchema>` ì‚¬ìš©**
   - ì˜í–¥ë„: ë‚®ìŒ (íƒ€ì… ì¤‘ë³µ ì œê±°)
   - ë‚œì´ë„: ì¤‘ê°„
   - íš¨ê³¼: íƒ€ì… ì¼ê´€ì„± í–¥ìƒ

## ì°¸ê³ ì‚¬í•­

- Team ê¸°ëŠ¥ì€ í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œ ì œì™¸ë˜ë¯€ë¡œ, íŒ¨í„´ë§Œ ì°¸ê³ í•˜ì—¬ í”„ë¡œì íŠ¸ ìƒì„±/ìˆ˜ì • ë“±ì— ì ìš©
- `z.coerce.number()`ëŠ” FormDataì—ì„œ ì˜¤ëŠ” ë¬¸ìì—´ì„ ìë™ìœ¼ë¡œ ìˆ«ìë¡œ ë³€í™˜í•˜ë¯€ë¡œ ë§¤ìš° ìœ ìš©í•¨
- `required` ì†ì„±ì€ HTML5 í‘œì¤€ì´ë¯€ë¡œ ë¸Œë¼ìš°ì €ì—ì„œ ìë™ìœ¼ë¡œ ê²€ì¦
- `z.infer<typeof formSchema>`ëŠ” íƒ€ì… ì¬ì‚¬ìš©ì— ìœ ìš©í•˜ì§€ë§Œ, FormSchemaì™€ Mutations íŒŒë¼ë¯¸í„°ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì£¼ì˜ í•„ìš”

