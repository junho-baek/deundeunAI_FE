# 8.1 Submit Job Page

## ì»¤ë°‹ ìš”ì•½

ì±„ìš© ê³µê³  ì œì¶œ í˜ì´ì§€ë¥¼ êµ¬í˜„í•œ ì»¤ë°‹ì…ë‹ˆë‹¤. Mutations íŒŒì¼ ë¶„ë¦¬, Zod ê²€ì¦ ê°•í™”, Form í•„ë“œ ê°œì„ , ë™ì  Meta í•¨ìˆ˜ ë“±ì˜ íŒ¨í„´ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

## ì£¼ìš” ë³€ê²½ì‚¬í•­

### 1. Mutations íŒŒì¼ ë¶„ë¦¬ (`mutations.ts`)

**ëª©ì **: ë°ì´í„° ìƒì„± ë¡œì§ì„ ë³„ë„ íŒŒì¼ë¡œ ë¶„ë¦¬

**êµ¬í˜„**:
```typescript
// app/features/jobs/mutations.ts
export const createJob = async (
  client: SupabaseClient<Database>,
  data: z.infer<typeof formSchema>
) => {
  const { data: jobData, error } = await client
    .from("jobs")
    .insert({
      position: data.position,
      overview: data.overview,
      // ... ë‚˜ë¨¸ì§€ í•„ë“œ
    })
    .select()
    .single();

  if (error) {
    throw error;
  }

  return jobData;
};
```

**íŠ¹ì§•**:
- Zod ìŠ¤í‚¤ë§ˆ íƒ€ì…ì„ ì§ì ‘ ì‚¬ìš© (`z.infer<typeof formSchema>`)
- ì—ëŸ¬ëŠ” ê·¸ëŒ€ë¡œ throwí•˜ì—¬ ìƒìœ„ì—ì„œ ì²˜ë¦¬

### 2. Loaderì—ì„œ ì¸ì¦ ì²´í¬

**êµ¬í˜„**:
```typescript
export const loader = async ({ request }: Route.LoaderArgs) => {
  const { client } = makeSSRClient(request);
  await getLoggedInUserId(client); // ì¸ì¦ ì²´í¬ë§Œ
};
```

**íŒ¨í„´**: í˜ì´ì§€ ì ‘ê·¼ ì‹œ ì¸ì¦ ì²´í¬, ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ê²½ìš° ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸

### 3. Zod ìŠ¤í‚¤ë§ˆ ì •ì˜ ë° Action í•¨ìˆ˜

**êµ¬í˜„**:
```typescript
export const formSchema = z.object({
  position: z.string().max(40),
  overview: z.string().max(400),
  responsibilities: z.string().max(400),
  qualifications: z.string().max(400),
  benefits: z.string().max(400),
  skills: z.string().max(400),
  companyName: z.string().max(40),
  companyLogoUrl: z.string().max(40),
  companyLocation: z.string().max(40),
  applyUrl: z.string().max(40),
  jobType: z.enum(JOB_TYPES.map((type) => type.value) as [string, ...string[]]),
  jobLocation: z.enum(
    LOCATION_TYPES.map((location) => location.value) as [string, ...string[]]
  ),
  salaryRange: z.enum(SALARY_RANGE),
});

export const action = async ({ request }: Route.ActionArgs) => {
  const { client } = makeSSRClient(request);
  await getLoggedInUserId(client);

  const formData = await request.formData();
  const { success, data, error } = formSchema.safeParse(
    Object.fromEntries(formData)
  );

  if (!success) {
    return {
      fieldErrors: error.flatten().fieldErrors,
    };
  }

  const { job_id } = await createJob(client, data);
  return redirect(`/jobs/${job_id}`);
};
```

**íŒ¨í„´**:
- `formSchema`ë¥¼ íŒŒì¼ ìƒë‹¨ì— exportí•˜ì—¬ mutationsì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥
- `safeParse`ë¡œ ì•ˆì „í•œ ê²€ì¦
- `error.flatten().fieldErrors`ë¡œ í•„ë“œë³„ ì—ëŸ¬ ì¶”ì¶œ
- ì„±ê³µ ì‹œ ìƒì„±ëœ ë¦¬ì†ŒìŠ¤ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

### 4. Form í•„ë“œ ê°œì„ 

**ë³€ê²½ ì „**:
```typescript
<InputPair
  label="Position"
  name="position"
  type="text"
  id="position"
/>
```

**ë³€ê²½ í›„**:
```typescript
<InputPair
  label="Position"
  name="position"
  type="text"
  id="position"
  required
  placeholder="i.e Senior React Developer"
  defaultValue="Senior React Developer"
/>
{actionData && "fieldErrors" in actionData && (
  <p className="text-red-500">{actionData.fieldErrors.position}</p>
)}
```

**ê°œì„  ì‚¬í•­**:
- `required` ì†ì„± ì¶”ê°€ (HTML5 ìœ íš¨ì„± ê²€ì‚¬)
- `placeholder` ì¶”ê°€ (ì‚¬ìš©ì ê°€ì´ë“œ)
- `defaultValue` ì¶”ê°€ (ê°œë°œ í¸ì˜ì„±)
- `actionData.fieldErrors`ë¡œ ì—ëŸ¬ í‘œì‹œ

### 5. Meta í•¨ìˆ˜ì—ì„œ ë™ì  ì œëª© ì‚¬ìš©

**ë³€ê²½ ì „**:
```typescript
export const meta: Route.MetaFunction = () => {
  return [{ title: "Job Details | wemake" }];
};
```

**ë³€ê²½ í›„**:
```typescript
export const meta: Route.MetaFunction = ({ data }) => {
  return [{ title: `${data.job.position} | wemake` }];
};
```

**ì¥ì **: ì‹¤ì œ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì  ë©”íƒ€ ì •ë³´ ìƒì„±

### 6. Formì— method="post" ëª…ì‹œ

**ë³€ê²½ ì „**:
```typescript
<Form className="...">
```

**ë³€ê²½ í›„**:
```typescript
<Form className="..." method="post">
```

**ì¥ì **: ëª…ì‹œì ìœ¼ë¡œ POST ìš”ì²­ì„ì„ í‘œì‹œ

## ì ìš© ë°©ì•ˆ

### âœ… ì´ë¯¸ ì ìš©ëœ íŒ¨í„´

1. **Mutations íŒŒì¼ ë¶„ë¦¬**: `app/features/projects/mutations.ts` ìƒì„± ì™„ë£Œ
2. **`getLoggedInUserId` ì‚¬ìš©**: ì—¬ëŸ¬ íŒŒì¼ì—ì„œ ì´ë¯¸ ì ìš©ë¨
3. **Zod ê²€ì¦**: `join-page.tsx`, `login-page.tsx`ì—ì„œ ì‚¬ìš© ì¤‘
4. **ë™ì  Meta í•¨ìˆ˜**: ì¼ë¶€ í˜ì´ì§€ì—ì„œ ì´ë¯¸ ì‚¬ìš© ì¤‘

### ğŸ”„ ì ìš© ê°€ëŠ¥í•œ íŒ¨í„´

#### 1. `project-create-page.tsx`ì— Zod ê²€ì¦ ê°•í™”

**í˜„ì¬ ìƒíƒœ**: ê°„ë‹¨í•œ ë¬¸ìì—´ ê²€ì‚¬ë§Œ ìˆ˜í–‰

**ì ìš© ë°©ì•ˆ**:
```typescript
// app/features/projects/pages/project-create-page.tsx
export const formSchema = z.object({
  keyword: z.string().min(1, "í”„ë¡œì íŠ¸ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.").max(100),
  aspectRatio: z.enum(["9:16", "16:9", "1:1"]).optional(),
  projectId: z.string().uuid().optional(),
});

export const action = async ({ request }: ActionFunctionArgs) => {
  const { client } = makeSSRClient(request);
  const profileId = await getLoggedInProfileId(client);

  const formData = await request.formData();
  const { success, data, error } = formSchema.safeParse(
    Object.fromEntries(formData)
  );

  if (!success) {
    return {
      fieldErrors: error.flatten().fieldErrors,
    };
  }

  // ... ë‚˜ë¨¸ì§€ ë¡œì§
};
```

**ì¥ì **:
- ë” ê°•ë ¥í•œ ìœ íš¨ì„± ê²€ì‚¬
- í•„ë“œë³„ ì—ëŸ¬ ë©”ì‹œì§€ ì œê³µ
- íƒ€ì… ì•ˆì •ì„± í–¥ìƒ

#### 2. Form í•„ë“œì— `required`, `placeholder`, `defaultValue` ì¶”ê°€

**ì ìš© ëŒ€ìƒ**:
- `project-create-page.tsx`ì˜ í‚¤ì›Œë“œ ì…ë ¥ í•„ë“œ
- ê¸°íƒ€ í¼ í˜ì´ì§€ë“¤

**ì˜ˆì‹œ**:
```typescript
<InputPair
  label="í”„ë¡œì íŠ¸ í‚¤ì›Œë“œ"
  name="keyword"
  type="text"
  id="keyword"
  required
  placeholder="ì˜ˆ: AI ë§ˆì¼€íŒ… ì˜ìƒ"
  defaultValue=""
/>
{actionData && "fieldErrors" in actionData && (
  <p className="text-red-500">
    {actionData.fieldErrors.keyword?.join(", ")}
  </p>
)}
```

**ì¥ì **:
- HTML5 ìœ íš¨ì„± ê²€ì‚¬ í™œìš©
- ì‚¬ìš©ì ê²½í—˜ ê°œì„ 
- ê°œë°œ í¸ì˜ì„± í–¥ìƒ

#### 3. Formì— `method="post"` ëª…ì‹œ

**ì ìš© ëŒ€ìƒ**: ëª¨ë“  Form ì»´í¬ë„ŒíŠ¸

**ì˜ˆì‹œ**:
```typescript
<Form className="..." method="post">
```

**ì¥ì **: ëª…ì‹œì ìœ¼ë¡œ POST ìš”ì²­ì„ì„ í‘œì‹œ

#### 4. Meta í•¨ìˆ˜ì—ì„œ ë™ì  ì œëª© ì‚¬ìš© ê°•í™”

**í˜„ì¬ ìƒíƒœ**: ì¼ë¶€ í˜ì´ì§€ì—ì„œë§Œ ì‚¬ìš©

**ì ìš© ë°©ì•ˆ**: ëª¨ë“  ìƒì„¸ í˜ì´ì§€ì—ì„œ loaderData ê¸°ë°˜ ë™ì  ì œëª© ì‚¬ìš©

**ì˜ˆì‹œ**:
```typescript
// project-detail-page.tsx (ê°€ìƒ)
export const meta: MetaFunction = ({ data }) => {
  return [
    { title: `${data.project.title} | ë“ ë“ AI` },
    { name: "description", content: data.project.description || "" },
  ];
};
```

## êµ¬í˜„ ìš°ì„ ìˆœìœ„

### ë†’ìŒ (ì¦‰ì‹œ ì ìš© ê¶Œì¥)

1. **`project-create-page.tsx`ì— Zod ê²€ì¦ ê°•í™”**
   - ì˜í–¥ë„: ë†’ìŒ (ë°ì´í„° ë¬´ê²°ì„±)
   - ë‚œì´ë„: ë‚®ìŒ
   - íš¨ê³¼: ì…ë ¥ ê²€ì¦ ê°•í™”, ì—ëŸ¬ ë©”ì‹œì§€ ê°œì„ 

2. **Form í•„ë“œì— `required`, `placeholder` ì¶”ê°€**
   - ì˜í–¥ë„: ì¤‘ê°„ (UX ê°œì„ )
   - ë‚œì´ë„: ë‚®ìŒ
   - íš¨ê³¼: ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ

### ì¤‘ê°„ (ì ì§„ì  ì ìš©)

3. **Formì— `method="post"` ëª…ì‹œ**
   - ì˜í–¥ë„: ë‚®ìŒ (ì½”ë“œ ëª…í™•ì„±)
   - ë‚œì´ë„: ë§¤ìš° ë‚®ìŒ
   - íš¨ê³¼: ì½”ë“œ ê°€ë…ì„± í–¥ìƒ

4. **Meta í•¨ìˆ˜ì—ì„œ ë™ì  ì œëª© ì‚¬ìš© ê°•í™”**
   - ì˜í–¥ë„: ë‚®ìŒ (SEO ê°œì„ )
   - ë‚œì´ë„: ë‚®ìŒ
   - íš¨ê³¼: SEO ë° ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

## ì°¸ê³ ì‚¬í•­

- Job ê¸°ëŠ¥ì€ í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œ ì œì™¸ë˜ë¯€ë¡œ, íŒ¨í„´ë§Œ ì°¸ê³ í•˜ì—¬ í”„ë¡œì íŠ¸ ìƒì„±/ìˆ˜ì • ë“±ì— ì ìš©
- Zod ìŠ¤í‚¤ë§ˆë¥¼ exportí•˜ì—¬ mutationsì—ì„œë„ íƒ€ì…ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥
- `actionData.fieldErrors`ëŠ” ë°°ì—´ í˜•íƒœì´ë¯€ë¡œ `.join(", ")`ë¡œ ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ì—¬ í‘œì‹œ
- `defaultValue`ëŠ” ê°œë°œ í¸ì˜ì„±ì„ ìœ„í•œ ê²ƒì´ë¯€ë¡œ, í”„ë¡œë•ì…˜ì—ì„œëŠ” ì œê±°í•˜ê±°ë‚˜ ë¹ˆ ë¬¸ìì—´ ì‚¬ìš©

